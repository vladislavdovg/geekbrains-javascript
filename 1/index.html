<!DOCTYPE html>
<html lang="ru">
<head>
	<meta charset="utf-8">
	<title>Document</title>
	<style>
		* { margin: 0; padding: 0; }
		#matrix { margin: 100px auto; width: 420px; border-right: 1px solid #ccc; border-bottom: 1px solid #ccc; }
		#matrix:after { content: ' '; display: block; clear: both; }
		#matrix .cell { float: left; width: 21px; height: 21px; box-sizing: border-box; border-left: 1px solid #ccc; border-top: 1px solid #ccc; }
		#matrix .cell.active { background-color: #ccc; }
	</style>
	<script>
		// Создание матрицы
		var createMatrix = function(sideLength) {
			this.sideLength = sideLength;
			var body = document.getElementsByTagName('body')[0];
			var matrix = document.createElement('div');
			matrix.id = 'matrix';
			body.appendChild(matrix);

			for (var i = 0; i < sideLength*sideLength; i++) {
				var div = document.createElement('div');
				div.className = 'cell';
				matrix.appendChild(div);
			}
		};

		// Получение ячейки матрицы по координатам
		var getCell = function(row, col) {
			var cellIndex = sideLength * (row - 1) + col - 1;
			return matrix.childNodes[cellIndex];
		};


		// Переключение ячейки матрицы
		var toggleCell = function(row, col) {
			// Принимает координаты ячейки,
			// если ячейка закрашина, убирает закраску
			// иначе закрашивает ячейку.
			var cell = getCell(row, col);
			cell.classList.toggle('active');
		};

		// Проверка на смерть
		var crashed = function(row, col) {
		};

		var snakeDirection = 39; // Глобальная

		var snakeMove = function(row, col) {
			toggleCell(row, col);
			switch (snakeDirection) {
				case 37:
					col--;
					break;
				case 38:
					row--;
					break;
				case 39:
					col++;
					break;
				case 40:
					row++;
					break;
			};
			toggleCell(row, col);
			setTimeout(snakeMove, 800, row, col);
		};

		var init = function() {
			createMatrix(20);
			startRow = 4;
			startCol = 4;
			toggleCell(startRow, startCol);
			setTimeout(snakeMove, 800, startRow, startCol);
		};

		// Точка входа
		window.onload = function() {
			init();

			// Обработка нажатия клавиш
			document.onkeydown = function(event) {
				if (!event) event = window.event;
				var keyCode = event.keyCode || event.which;
				if (keyCode == 37 || keyCode == 38 || keyCode == 39 || keyCode == 40) {
					snakeDirection = keyCode;
				};
			};
		};
	</script>
</head>
<body>
</body>
</html>